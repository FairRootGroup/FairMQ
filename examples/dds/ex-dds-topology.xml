<topology name="ExampleDDS">

    <property name="data1" />
    <property name="data2" />

    <declrequirement name="SamplerWorker" type="wnname" value="sampler"/>
    <declrequirement name="ProcessorWorker" type="wnname" value="processor"/>
    <declrequirement name="SinkWorker" type="wnname" value="sink"/>

    <decltask id="Sampler">
        <exe reachable="true">fairmq-ex-dds-sampler --id sampler --channel-config name=data1,type=push,method=bind -P dds</exe>
        <requirements>
            <name>SamplerWorker</name>
        </requirements>
        <properties>
            <name access="write">data1</name>
        </properties>
    </decltask>

    <decltask id="Processor">
        <exe reachable="true">fairmq-ex-dds-processor --id processor_%taskIndex% --channel-config name=data1,type=pull,method=connect name=data2,type=push,method=connect -P dds</exe>
        <requirements>
            <id>ProcessWorker</id>
        </requirements>
        <properties>
            <name access="read">data1</name>
            <name access="read">data2</name>
        </properties>
    </decltask>

    <decltask id="Sink">
        <exe reachable="true">fairmq-ex-dds-sink --id sink --channel-config name=data2,type=pull,method=bind -P dds</exe>
        <requirements>
            <name>SinkWorker</name>
        </requirements>
        <properties>
            <name access="write">data2</name>
        </properties>
    </decltask>

    <main name="main">
        <task>Sampler</task>
        <task>Sink</task>
        <group name="ProcessorGroup" n="10">
            <task>Processor</task>
        </group>
    </main>

</topology>
